(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.jiboProgrammingChallenge = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
/// <reference path="../typings/index.d.ts" />
var PIXI = require('pixi.js');
// global vars
// system
var renderer = new PIXI.WebGLRenderer(3000, 3000);
var stage = new PIXI.Container();
// game constants
var HELP_OFFSET_X = 10;
var HELP_OFFSET_Y = 10;
var BOARD_OFFSET_X = 10;
var BOARD_OFFSET_Y = 70;
var BOARD_PADDING_X = 4;
var BOARD_PADDING_Y = 4;
// game resources
var resources;
var fontStyle;
var arrowTextures = [];
var helpText;
// game state
var boardSize = 10;
var board = [];
function initialize() {
    // System
    document.body.appendChild(renderer.view);
    // Textures
    PIXI.loader
        .add('tile1', 'images/tile_blue.png')
        .add('tile2', 'images/tile_red.png')
        .add('arrow_up', 'images/arrow_up.png')
        .add('arrow_right', 'images/arrow_right.png')
        .add('arrow_down', 'images/arrow_down.png')
        .add('arrow_left', 'images/arrow_left.png')
        .add('coin', 'images/coin.png')
        .load(function (loader, newResources) {
        resources = newResources;
        arrowTextures[0] = resources.arrow_up.texture;
        arrowTextures[1] = resources.arrow_right.texture;
        arrowTextures[2] = resources.arrow_down.texture;
        arrowTextures[3] = resources.arrow_left.texture;
        generateUi();
        generateBoard();
        execFrame();
    });
}
function generateUi() {
    // Setup style
    fontStyle = new PIXI.TextStyle({
        fontFamily: 'Arial',
        fontSize: 20,
        fill: 'white'
    });
    // Setup help text
    helpText = new PIXI.Text("Click on a tile to drop a coin.\nSee how long you can get it to stay before falling off the board.", fontStyle);
    helpText.x = HELP_OFFSET_X;
    helpText.y = HELP_OFFSET_Y;
    stage.addChild(helpText);
    console.log("Helo?");
}
function generateBoard() {
    // Setup sprites
    for (var y = 0; y < boardSize; ++y) {
        board[y] = [];
        for (var x = 0; x < boardSize; ++x) {
            var tileTexture = ((x + y) % 2 == 0) ? resources.tile1.texture : resources.tile2.texture;
            var positionX = x * (64 + BOARD_PADDING_X) + BOARD_OFFSET_X;
            var positionY = y * (64 + BOARD_PADDING_Y) + BOARD_OFFSET_Y;
            board[y][x] = new PIXI.Sprite(tileTexture);
            var tile = board[y][x];
            tile.position.x = positionX;
            tile.position.y = positionY;
            tile.arrow = new PIXI.Sprite(arrowTextures[2]);
            tile.arrowType = 2;
            tile.addChild(tile.arrow);
            tile.interactive = true;
            tile.buttonMode = true;
            tile.on('mouseup', boardClick);
            stage.addChild(tile);
        }
    }
    // Setup neighbor links
    for (var y = 0; y < boardSize; ++y) {
        for (var x = 0; x < boardSize; ++x) {
            var tile = board[y][x];
            tile.neighbor = [];
            if (y > 0) {
                tile.neighbor[0] = board[y - 1][x];
            }
            if (x < boardSize - 1) {
                tile.neighbor[1] = board[y][x + 1];
            }
            if (y < boardSize - 1) {
                tile.neighbor[2] = board[y + 1][x];
            }
            if (x > 0) {
                tile.neighbor[3] = board[y][x - 1];
            }
        }
    }
    randomizeBoard();
}
function randomizeBoard() {
    for (var y = 0; y < boardSize; ++y) {
        for (var x = 0; x < boardSize; ++x) {
            var type = Math.floor(Math.random() * 4);
            board[y][x].arrow.texture = arrowTextures[type];
            board[y][x].arrowType = type;
        }
    }
}
function boardClick(event) {
    var tile = event.target;
    tile = tile.neighbor[tile.arrowType];
    if (tile == null) {
    }
    else {
        tile.coin = new PIXI.Sprite(resources.coin.texture);
        tile.addChild(tile.coin);
    }
}
function execFrame() {
    requestAnimationFrame(execFrame);
    renderer.render(stage);
}
initialize();
},{"pixi.js":undefined}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztBQ0FBLDhDQUE4QztBQUM5QyxJQUFPLElBQUksV0FBVyxTQUFTLENBQUMsQ0FBQztBQUVqQyxjQUFjO0FBQ1YsU0FBUztBQUNULElBQU0sUUFBUSxHQUFzQixJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3ZFLElBQU0sS0FBSyxHQUFrQixJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztBQUNsRCxpQkFBaUI7QUFDakIsSUFBTSxhQUFhLEdBQUcsRUFBRSxDQUFDO0FBQ3pCLElBQU0sYUFBYSxHQUFHLEVBQUUsQ0FBQztBQUN6QixJQUFNLGNBQWMsR0FBRyxFQUFFLENBQUM7QUFDMUIsSUFBTSxjQUFjLEdBQUcsRUFBRSxDQUFDO0FBQzFCLElBQU0sZUFBZSxHQUFHLENBQUMsQ0FBQztBQUMxQixJQUFNLGVBQWUsR0FBRyxDQUFDLENBQUM7QUFDMUIsaUJBQWlCO0FBQ2pCLElBQUksU0FBYSxDQUFDO0FBQ2xCLElBQUksU0FBUyxDQUFDO0FBQ2QsSUFBSSxhQUFhLEdBQUcsRUFBRSxDQUFDO0FBQ3ZCLElBQUksUUFBUSxDQUFDO0FBQ2IsYUFBYTtBQUNiLElBQUksU0FBUyxHQUFHLEVBQUUsQ0FBQztBQUNuQixJQUFJLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDbkI7SUFDSSxTQUFTO0lBQ1QsUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3pDLFdBQVc7SUFDWCxJQUFJLENBQUMsTUFBTTtTQUNOLEdBQUcsQ0FBQyxPQUFPLEVBQUUsc0JBQXNCLENBQUM7U0FDcEMsR0FBRyxDQUFDLE9BQU8sRUFBRSxxQkFBcUIs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QUM7SUFDckMsRUFBRSxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDbkIsQ0FBQztJQUFDLElBQUksQ0FBQyxDQUFDO1FBQ0osSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNwRCxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM3QixDQUFDO0FBQ0wsQ0FBQztBQUVEO0lBQ0kscUJBQXFCLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDakMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUMzQixDQUFDO0FBRUQsVUFBVSxFQUFFLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGluZ3MvaW5kZXguZC50c1wiIC8+XHJcbmltcG9ydCBQSVhJID0gcmVxdWlyZSgncGl4aS5qcycpO1xyXG5cclxuLy8gZ2xvYmFsIHZhcnNcclxuICAgIC8vIHN5c3RlbVxyXG4gICAgY29uc3QgcmVuZGVyZXI6UElYSS5XZWJHTFJlbmRlcmVyID0gbmV3IFBJWEkuV2ViR0xSZW5kZXJlcigzMDAwLCAzMDAwKTtcclxuICAgIGNvbnN0IHN0YWdlOlBJWEkuQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcbiAgICAvLyBnYW1lIGNvbnN0YW50c1xyXG4gICAgY29uc3QgSEVMUF9PRkZTRVRfWCA9IDEwO1xyXG4gICAgY29uc3QgSEVMUF9PRkZTRVRfWSA9IDEwO1xyXG4gICAgY29uc3QgQk9BUkRfT0ZGU0VUX1ggPSAxMDtcclxuICAgIGNvbnN0IEJPQVJEX09GRlNFVF9ZID0gNzA7XHJcbiAgICBjb25zdCBCT0FSRF9QQURESU5HX1ggPSA0O1xyXG4gICAgY29uc3QgQk9BUkRfUEFERElOR19ZID0gNDtcclxuICAgIC8vIGdhbWUgcmVzb3VyY2VzXHJcbiAgICBsZXQgcmVzb3VyY2VzOmFueTtcclxuICAgIHZhciBmb250U3R5bGU7XHJcbiAgICB2YXIgYXJyb3dUZXh0dXJlcyA9IFtdO1xyXG4gICAgdmFyIGhlbHBUZXh0O1xyXG4gICAgLy8gZ2FtZSBzdGF0ZVxyXG4gICAgdmFyIGJvYXJkU2l6ZSA9IDEwO1xyXG4gICAgdmFyIGJvYXJkID0gW107XHJcbmZ1bmN0aW9uIGluaXRpYWxpemUoKSB7XHJcbiAgICAvLyBTeXN0ZW1cclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocmVuZGVyZXIudmlldyk7XHJcbiAgICAvLyBUZXh0dXJlc1xyXG4gICAgUElYSS5sb2FkZXJcclxuICAgICAgICAuYWRkKCd0aWxlMScsICdpbWFnZXMvdGlsZV9ibHVlLnBuZycpXHJcbiAgICAgICAgLmFkZCgndGlsZTInLCAnaW1hZ2VzL3RpbGVfcmVkLnBuZycpXHJcbiAgICAgICAgLmFkZCgnYXJyb3dfdXAnLCAnaW1hZ2VzL2Fycm93X3VwLnBuZycpXHJcbiAgICAgICAgLmFkZCgnYXJyb3dfcmlnaHQnLCAnaW1hZ2VzL2Fycm93X3JpZ2h0LnBuZycpXHJcbiAgICAgICAgLmFkZCgnYXJyb3dfZG93bicsICdpbWFnZXMvYXJyb3dfZG93bi5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ2Fycm93X2xlZnQnLCAnaW1hZ2VzL2Fycm93X2xlZnQucG5nJylcclxuICAgICAgICAuYWRkKCdjb2luJywgICAgJ2ltYWdlcy9jb2luLnBuZycpXHJcbiAgICAgICAgLmxvYWQoZnVuY3Rpb24gKGxvYWRlcjpQSVhJLmxvYWRlcnMuTG9hZGVyLCBuZXdSZXNvdXJjZXM6YW55KSB7XHJcbiAgICAgICAgICAgIHJlc291cmNlcyA9IG5ld1Jlc291cmNlcztcclxuICAgICAgICAgICAgYXJyb3dUZXh0dXJlc1swXSA9IHJlc291cmNlcy5hcnJvd191cC50ZXh0dXJlO1xyXG4gICAgICAgICAgICBhcnJvd1RleHR1cmVzWzFdID0gcmVzb3VyY2VzLmFycm93X3JpZ2h0LnRleHR1cmU7XHJcbiAgICAgICAgICAgIGFycm93VGV4dHVyZXNbMl0gPSByZXNvdXJjZXMuYXJyb3dfZG93bi50ZXh0dXJlO1xyXG4gICAgICAgICAgICBhcnJvd1RleHR1cmVzWzNdID0gcmVzb3VyY2VzLmFycm93X2xlZnQudGV4dHVyZTtcclxuICAgICAgICAgICAgZ2VuZXJhdGVVaSgpO1xyXG4gICAgICAgICAgICBnZW5lcmF0ZUJvYXJkKCk7XHJcbiAgICAgICAgICAgIGV4ZWNGcmFtZSgpO1xyXG4gICAgICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZW5lcmF0ZVVpKCkge1xyXG4gICAgLy8gU2V0dXAgc3R5bGVcclxuICAgIGZvbnRTdHlsZSA9IG5ldyBQSVhJLlRleHRTdHlsZSh7XHJcbiAgICAgICAgZm9udEZhbWlseTogJ0FyaWFsJyxcclxuICAgICAgICBmb250U2l6ZTogMjAsXHJcbiAgICAgICAgZmlsbDogJ3doaXRlJyxcclxuICAgIH0pO1xyXG4gICAgLy8gU2V0dXAgaGVscCB0ZXh0XHJcbiAgICBoZWxwVGV4dCA9IG5ldyBQSVhJLlRleHQoXCJDbGljayBvbiBhIHRpbGUgdG8gZHJvcCBhIGNvaW4uXFxuU2VlIGhvdyBsb25nIHlvdSBjYW4gZ2V0IGl0IHRvIHN0YXkgYmVmb3JlIGZhbGxpbmcgb2ZmIHRoZSBib2FyZC5cIiwgZm9udFN0eWxlKTtcclxuICAgIGhlbHBUZXh0LnggPSBIRUxQX09GRlNFVF9YO1xyXG4gICAgaGVscFRleHQueSA9IEhFTFBfT0ZGU0VUX1k7XHJcbiAgICBzdGFnZS5hZGRDaGlsZChoZWxwVGV4dCk7XHJcbiAgICBjb25zb2xlLmxvZyhcIkhlbG8/XCIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZW5lcmF0ZUJvYXJkKCkge1xyXG4gICAgLy8gU2V0dXAgc3ByaXRlc1xyXG4gICAgZm9yICh2YXIgeSA9IDA7IHkgPCBib2FyZFNpemU7ICsreSkge1xyXG4gICAgICAgIGJvYXJkW3ldID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBib2FyZFNpemU7ICsreCkge1xyXG4gICAgICAgICAgICB2YXIgdGlsZVRleHR1cmUgPSAoKHggKyB5KSAlIDIgPT0gMCkgPyByZXNvdXJjZXMudGlsZTEudGV4dHVyZSA6IHJlc291cmNlcy50aWxlMi50ZXh0dXJlO1xyXG4gICAgICAgICAgICB2YXIgcG9zaXRpb25YID0geCAqICg2NCArIEJPQVJEX1BBRERJTkdfWCkgKyBCT0FSRF9PRkZTRVRfWDtcclxuICAgICAgICAgICAgdmFyIHBvc2l0aW9uWSA9IHkgKiAoNjQgKyBCT0FSRF9QQURESU5HX1kpICsgQk9BUkRfT0ZGU0VUX1k7XHJcbiAgICAgICAgICAgIGJvYXJkW3ldW3hdID0gbmV3IFBJWEkuU3ByaXRlKHRpbGVUZXh0dXJlKTtcclxuICAgICAgICAgICAgdmFyIHRpbGUgPSBib2FyZFt5XVt4XTtcclxuICAgICAgICAgICAgdGlsZS5wb3NpdGlvbi54ID0gcG9zaXRpb25YO1xyXG4gICAgICAgICAgICB0aWxlLnBvc2l0aW9uLnkgPSBwb3NpdGlvblk7XHJcbiAgICAgICAgICAgIHRpbGUuYXJyb3cgPSBuZXcgUElYSS5TcHJpdGUoYXJyb3dUZXh0dXJlc1syXSk7XHJcbiAgICAgICAgICAgIHRpbGUuYXJyb3dUeXBlID0gMjtcclxuICAgICAgICAgICAgdGlsZS5hZGRDaGlsZCh0aWxlLmFycm93KTtcclxuICAgICAgICAgICAgdGlsZS5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRpbGUuYnV0dG9uTW9kZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRpbGUub24oJ21vdXNldXAnLCBib2FyZENsaWNrKTtcclxuICAgICAgICAgICAgc3RhZ2UuYWRkQ2hpbGQodGlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gU2V0dXAgbmVpZ2hib3IgbGlua3NcclxuICAgIGZvciAodmFyIHkgPSAwOyB5IDwgYm9hcmRTaXplOyArK3kpIHtcclxuICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGJvYXJkU2l6ZTsgKyt4KSB7XHJcbiAgICAgICAgICAgIHZhciB0aWxlID0gYm9hcmRbeV1beF07XHJcbiAgICAgICAgICAgIHRpbGUubmVpZ2hib3IgPSBbXTtcclxuICAgICAgICAgICAgaWYgKHkgPiAwKSAgICAgICAgICAgeyB0aWxlLm5laWdoYm9yWzBdID0gYm9hcmRbeS0xXVt4XTsgfVxyXG4gICAgICAgICAgICBpZiAoeCA8IGJvYXJkU2l6ZS0xKSB7IHRpbGUubmVpZ2hib3JbMV0gPSBib2FyZFt5XVt4KzFdOyB9XHJcbiAgICAgICAgICAgIGlmICh5IDwgYm9hcmRTaXplLTEpIHsgdGlsZS5uZWlnaGJvclsyXSA9IGJvYXJkW3krMV1beF07IH1cclxuICAgICAgICAgICAgaWYgKHggPiAwKSAgICAgICAgICAgeyB0aWxlLm5laWdoYm9yWzNdID0gYm9hcmRbeV1beC0xXTsgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJhbmRvbWl6ZUJvYXJkKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJhbmRvbWl6ZUJvYXJkKCkge1xyXG4gICAgZm9yICh2YXIgeSA9IDA7IHkgPCBib2FyZFNpemU7ICsreSkge1xyXG4gICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgYm9hcmRTaXplOyArK3gpIHtcclxuICAgICAgICAgICAgdmFyIHR5cGUgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0KTtcclxuICAgICAgICAgICAgYm9hcmRbeV1beF0uYXJyb3cudGV4dHVyZSA9IGFycm93VGV4dHVyZXNbdHlwZV07XHJcbiAgICAgICAgICAgIGJvYXJkW3ldW3hdLmFycm93VHlwZSA9IHR5cGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBib2FyZENsaWNrKGV2ZW50KSB7XHJcbiAgICB2YXIgdGlsZSA9IGV2ZW50LnRhcmdldDtcclxuICAgIHRpbGUgPSB0aWxlLm5laWdoYm9yW3RpbGUuYXJyb3dUeXBlXTtcclxuICAgIGlmICh0aWxlID09IG51bGwpIHtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGlsZS5jb2luID0gbmV3IFBJWEkuU3ByaXRlKHJlc291cmNlcy5jb2luLnRleHR1cmUpO1xyXG4gICAgICAgIHRpbGUuYWRkQ2hpbGQodGlsZS5jb2luKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZXhlY0ZyYW1lKCkge1xyXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGV4ZWNGcmFtZSk7XHJcbiAgICByZW5kZXJlci5yZW5kZXIoc3RhZ2UpO1xyXG59XHJcblxyXG5pbml0aWFsaXplKCk7XHJcbiJdfQ==
