(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.jiboProgrammingChallenge = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
/// <reference path="../typings/index.d.ts" />
var PIXI = require('pixi.js');
//import audio = require('pixi-sound');
// global vars
// system
var renderer = new PIXI.WebGLRenderer(3000, 3000);
var stage = new PIXI.Container();
// game constants
var HELP_OFFSET_X = 10;
var HELP_OFFSET_Y = 10;
var BOARD_OFFSET_X = 10;
var BOARD_OFFSET_Y = 70;
var BOARD_PADDING_X = 2;
var BOARD_PADDING_Y = 2;
var FRAME_SPEED = 100;
var coinAnimationFrames = [[0, 3, 4, 0], [0, 1, 2, 0], [0, 4, 3, 0], [0, 2, 1, 0]];
// game resources
var resources;
var fontStyle;
var arrowTextures;
var explosionTextures;
var coinTextures;
var helpText;
// game state
var boardSize = 10;
var board = [];
var coin;
var explosion;
var coinTrail = [];
var frameTime = 0;
function initialize() {
    // System
    document.body.appendChild(renderer.view);
    // Textures
    PIXI.loader
        .add('tile1', 'images/tile_blue.png')
        .add('tile2', 'images/tile_green.png')
        .add('arrow_up', 'images/arrow_up.png')
        .add('arrow_right', 'images/arrow_right.png')
        .add('arrow_down', 'images/arrow_down.png')
        .add('arrow_left', 'images/arrow_left.png')
        .add('explosion_1', 'images/explosion_1.png')
        .add('explosion_2', 'images/explosion_2.png')
        .add('explosion_3', 'images/explosion_3.png')
        .add('explosion_4', 'images/explosion_4.png')
        .add('explosion_5', 'images/explosion_5.png')
        .add('coin', 'images/coin.png')
        .add('coin_horizontal1', 'images/coin_horizontal1.png')
        .add('coin_horizontal2', 'images/coin_horizontal2.png')
        .add('coin_vertical1', 'images/coin_vertical1.png')
        .add('coin_vertical2', 'images/coin_vertical2.png')
        .load(function (loader, newResources) {
        resources = newResources;
        setupTextureResources();
        setupUi();
        setupBoard();
        setupCoinAndExplosion();
        runMainLoop(0);
    });
}
function setupTextureResources() {
    arrowTextures = [];
    arrowTextures[0] = resources.arrow_up.texture;
    arrowTextures[1] = resources.arrow_right.texture;
    arrowTextures[2] = resources.arrow_down.texture;
    arrowTextures[3] = resources.arrow_left.texture;
    explosionTextures = [];
    explosionTextures[0] = resources.explosion_1.texture;
    explosionTextures[1] = resources.explosion_2.texture;
    explosionTextures[2] = resources.explosion_3.texture;
    explosionTextures[3] = resources.explosion_4.texture;
    explosionTextures[4] = resources.explosion_5.texture;
    coinTextures = [];
    coinTextures[0] = resources.coin.texture;
    coinTextures[1] = resources.coin_horizontal1.texture;
    coinTextures[2] = resources.coin_horizontal2.texture;
    coinTextures[3] = resources.coin_vertical1.texture;
    coinTextures[4] = resources.coin_vertical2.texture;
}
function setupUi() {
    // Setup style
    fontStyle = new PIXI.TextStyle({
        fontFamily: 'Arial',
        fontSize: 20,
        fill: 'white'
    });
    // Setup help text
    helpText = new PIXI.Text("Click on a tile to drop a coin.\nSee quickly you can find the paths off of the board.", fontStyle);
    helpText.x = HELP_OFFSET_X;
    helpText.y = HELP_OFFSET_Y;
    stage.addChild(helpText);
}
function setupBoard() {
    // Setup board sprites
    for (var y = 0; y < boardSize; ++y) {
        board[y] = [];
        for (var x = 0; x < boardSize; ++x) {
            // tile
            var tileTexture = ((x + y) % 2 == 0) ? resources.tile1.texture : resources.tile2.texture;
            var positionX = x * (64 + BOARD_PADDING_X) + BOARD_OFFSET_X;
            var positionY = y * (64 + BOARD_PADDING_Y) + BOARD_OFFSET_Y;
            board[y][x] = new PIXI.Sprite(tileTexture);
            var tile = board[y][x];
            tile.position.x = positionX;
            tile.position.y = positionY;
            stage.addChild(tile);
            // arrow
            tile.arrow = new PIXI.Sprite(arrowTextures[2]);
            tile.arrowType = 2;
            tile.addChild(tile.arrow);
            // mouse clicks
            tile.interactive = true;
            tile.buttonMode = true;
            tile.on('mouseup', onBoardClick);
        }
    }
    // Setup neighbor links
    for (var y = 0; y < boardSize; ++y) {
        for (var x = 0; x < boardSize; ++x) {
            var tile = board[y][x];
            tile.neighbor = [];
            if (y > 0) {
                tile.neighbor[0] = board[y - 1][x];
            }
            if (x < boardSize - 1) {
                tile.neighbor[1] = board[y][x + 1];
            }
            if (y < boardSize - 1) {
                tile.neighbor[2] = board[y + 1][x];
            }
            if (x > 0) {
                tile.neighbor[3] = board[y][x - 1];
            }
        }
    }
    randomizeBoard();
}
function setupCoinAndExplosion() {
    coin = new PIXI.Sprite(resources.coin.texture);
    coin.frame = -1;
    coin.visible = false;
    stage.addChild(coin);
    explosion = new PIXI.Sprite(explosionTextures[0]);
    explosion.frame = -1;
    explosion.visible = false;
    stage.addChild(explosion);
}
function randomizeBoard() {
    for (var y = 0; y < boardSize; ++y) {
        for (var x = 0; x < boardSize; ++x) {
            var type = Math.floor(Math.random() * 4);
            board[y][x].arrow.texture = arrowTextures[type];
            board[y][x].arrowType = type;
        }
    }
}
function onBoardClick(event) {
    var tile = event.target;
    // remove the explosion (if still visible)
    explosion.visible = false;
    // place the coin
    coin.tile = tile;
    coin.position = tile.position;
    coin.direction = tile.arrowType;
    coin.visible = true;
}
function runFrameLogic() {
    // animate coin
    if (coin.visible) {
        coin.frame += 1;
        if (coin.frame > 3) {
            coin.frame = 0;
        }
        coin.texture = coinTextures[coinAnimationFrames[coin.direction][coin.frame]];
    }
    // handle coin movement
    if (coin.visible && coin.frame == 2 && !explosion.visible) {
        var tile = coin.tile;
        // add to coin trail
        var newCoinTrail = new PIXI.Sprite(resources.coin.texture);
        coinTrail.push(newCoinTrail);
        newCoinTrail.position = coin.position;
        newCoinTrail["tile"] = coin.tile;
        newCoinTrail.alpha = .35;
        stage.addChild(newCoinTrail);
        // Get new position
        var newTile = tile.neighbor[tile.arrowType];
        // Check for trail loop
        if (newTile) {
            for (var i = 0; i < coinTrail.length; ++i) {
                if (coinTrail[i].tile == newTile) {
                    explosion.visible = true;
                    break;
                }
            }
        }
        // Remove coin (if applicable)
        if (!newTile || explosion.visible) {
            while (coinTrail.length > 0) {
                var coinTrailItem = coinTrail.pop();
                stage.removeChild(coinTrailItem);
                coinTrailItem.destroy();
            }
            if (!explosion.visible) {
                coin.visible = false;
                coin.frame = -1;
            }
        }
        else {
            coin.tile = newTile;
            coin.position = newTile.position;
            coin.direction = newTile.arrowType;
        }
    }
    // animate explosion
    if (explosion.visible) {
        ++explosion.frame;
        // special frames
        if (explosion.frame == 0) {
            explosion.position = coin.position;
        }
        else if (explosion.frame == 1) {
            coin.visible = false;
            coin.frame = -1;
        }
        // Draw or remove
        if (explosion.frame == 5) {
            explosion.visible = false;
            explosion.frame = -1;
        }
        else {
            explosion.texture = explosionTextures[explosion.frame];
        }
    }
}
function runMainLoop(timeStamp) {
    // call "runFrameLogic()" at FRAME_SPEED intervals
    if (timeStamp - frameTime > FRAME_SPEED) {
        frameTime = timeStamp;
        runFrameLogic();
    }
    // Render and loop
    renderer.render(stage);
    requestAnimationFrame(runMainLoop);
}
initialize();
},{"pixi.js":undefined}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztBQ0NBLDhDQUE4QztBQUM5QyxJQUFPLElBQUksV0FBVyxTQUFTLENBQUMsQ0FBQztBQUNqQyx1Q0FBdUM7QUFHdkMsY0FBYztBQUNWLFNBQVM7QUFDVCxJQUFNLFFBQVEsR0FBc0IsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztBQUN2RSxJQUFNLEtBQUssR0FBa0IsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDbEQsaUJBQWlCO0FBQ2pCLElBQU0sYUFBYSxHQUFHLEVBQUUsQ0FBQztBQUN6QixJQUFNLGFBQWEsR0FBRyxFQUFFLENBQUM7QUFDekIsSUFBTSxjQUFjLEdBQUcsRUFBRSxDQUFDO0FBQzFCLElBQU0sY0FBYyxHQUFHLEVBQUUsQ0FBQztBQUMxQixJQUFNLGVBQWUsR0FBRyxDQUFDLENBQUM7QUFDMUIsSUFBTSxlQUFlLEdBQUcsQ0FBQyxDQUFDO0FBQzFCLElBQU0sV0FBVyxHQUFHLEdBQUcsQ0FBQztBQUN4QixJQUFNLG1CQUFtQixHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3RFLGlCQUFpQjtBQUNqQixJQUFJLFNBQWEsQ0FBQztBQUNsQixJQUFJLFNBQVMsQ0FBQztBQUNkLElBQUksYUFBYSxDQUFDO0FB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QUM7SUFDRCx1QkFBdUI7SUFDdkIsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQztRQUNqQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQ2pDLElBQUksSUFBSSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN2QixJQUFJLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztZQUNuQixFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQVcsQ0FBQztnQkFBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFBQyxDQUFDO1lBQzFELEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLEdBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUM7WUFBQyxDQUFDO1lBQzFELEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLEdBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFBQyxDQUFDO1lBQzFELEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBVyxDQUFDO2dCQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBQyxDQUFDLENBQUMsQ0FB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QUNMLENBQUM7QUFDTCxDQUFDO0FBRUQscUJBQXFCLFNBQVM7SUFDMUIsa0RBQWtEO0lBQ2xELEVBQUUsQ0FBQyxDQUFDLFNBQVMsR0FBQyxTQUFTLEdBQUcsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUNwQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQ3RCLGFBQWEsRUFBRSxDQUFDO0lBQ3BCLENBQUM7SUFDRCxrQkFBa0I7SUFDbEIsUUFBUSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN2QixxQkFBcUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUN2QyxDQUFDO0FBRUQsVUFBVSxFQUFFLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90eXBpbmdzL2luZGV4LmQudHNcIiAvPlxyXG5pbXBvcnQgUElYSSA9IHJlcXVpcmUoJ3BpeGkuanMnKTtcclxuLy9pbXBvcnQgYXVkaW8gPSByZXF1aXJlKCdwaXhpLXNvdW5kJyk7XHJcblxyXG5cclxuLy8gZ2xvYmFsIHZhcnNcclxuICAgIC8vIHN5c3RlbVxyXG4gICAgY29uc3QgcmVuZGVyZXI6UElYSS5XZWJHTFJlbmRlcmVyID0gbmV3IFBJWEkuV2ViR0xSZW5kZXJlcigzMDAwLCAzMDAwKTtcclxuICAgIGNvbnN0IHN0YWdlOlBJWEkuQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XHJcbiAgICAvLyBnYW1lIGNvbnN0YW50c1xyXG4gICAgY29uc3QgSEVMUF9PRkZTRVRfWCA9IDEwO1xyXG4gICAgY29uc3QgSEVMUF9PRkZTRVRfWSA9IDEwO1xyXG4gICAgY29uc3QgQk9BUkRfT0ZGU0VUX1ggPSAxMDtcclxuICAgIGNvbnN0IEJPQVJEX09GRlNFVF9ZID0gNzA7XHJcbiAgICBjb25zdCBCT0FSRF9QQURESU5HX1ggPSAyO1xyXG4gICAgY29uc3QgQk9BUkRfUEFERElOR19ZID0gMjtcclxuICAgIGNvbnN0IEZSQU1FX1NQRUVEID0gMTAwO1xyXG4gICAgY29uc3QgY29pbkFuaW1hdGlvbkZyYW1lcyA9IFtbMCwzLDQsMF0sWzAsMSwyLDBdLFswLDQsMywwXSxbMCwyLDEsMF1dO1xyXG4gICAgLy8gZ2FtZSByZXNvdXJjZXNcclxuICAgIGxldCByZXNvdXJjZXM6YW55O1xyXG4gICAgdmFyIGZvbnRTdHlsZTtcclxuICAgIHZhciBhcnJvd1RleHR1cmVzO1xyXG4gICAgdmFyIGV4cGxvc2lvblRleHR1cmVzO1xyXG4gICAgdmFyIGNvaW5UZXh0dXJlcztcclxuICAgIHZhciBoZWxwVGV4dDtcclxuICAgIC8vIGdhbWUgc3RhdGVcclxuICAgIHZhciBib2FyZFNpemUgPSAxMDtcclxuICAgIHZhciBib2FyZCA9IFtdO1xyXG4gICAgdmFyIGNvaW47XHJcbiAgICB2YXIgZXhwbG9zaW9uO1xyXG4gICAgdmFyIGNvaW5UcmFpbCA9IFtdO1xyXG4gICAgdmFyIGZyYW1lVGltZSA9IDA7XHJcblxyXG5cclxuZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcclxuICAgIC8vIFN5c3RlbVxyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChyZW5kZXJlci52aWV3KTtcclxuICAgIC8vIFRleHR1cmVzXHJcbiAgICBQSVhJLmxvYWRlclxyXG4gICAgICAgIC5hZGQoJ3RpbGUxJywgJ2ltYWdlcy90aWxlX2JsdWUucG5nJylcclxuICAgICAgICAuYWRkKCd0aWxlMicsICdpbWFnZXMvdGlsZV9ncmVlbi5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ2Fycm93X3VwJywgJ2ltYWdlcy9hcnJvd191cC5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ2Fycm93X3JpZ2h0JywgJ2ltYWdlcy9hcnJvd19yaWdodC5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ2Fycm93X2Rvd24nLCAnaW1hZ2VzL2Fycm93X2Rvd24ucG5nJylcclxuICAgICAgICAuYWRkKCdhcnJvd19sZWZ0JywgJ2ltYWdlcy9hcnJvd19sZWZ0LnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzEnLCAnaW1hZ2VzL2V4cGxvc2lvbl8xLnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzInLCAnaW1hZ2VzL2V4cGxvc2lvbl8yLnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzMnLCAnaW1hZ2VzL2V4cGxvc2lvbl8zLnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzQnLCAnaW1hZ2VzL2V4cGxvc2lvbl80LnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzUnLCAnaW1hZ2VzL2V4cGxvc2lvbl81LnBuZycpXHJcbiAgICAgICAgLmFkZCgnY29pbicsICAgICdpbWFnZXMvY29pbi5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ2NvaW5faG9yaXpvbnRhbDEnLCAgICAnaW1hZ2VzL2NvaW5faG9yaXpvbnRhbDEucG5nJylcclxuICAgICAgICAuYWRkKCdjb2luX2hvcml6b250YWwyJywgICAgJ2ltYWdlcy9jb2luX2hvcml6b250YWwyLnBuZycpXHJcbiAgICAgICAgLmFkZCgnY29pbl92ZXJ0aWNhbDEnLCAgICAnaW1hZ2VzL2NvaW5fdmVydGljYWwxLnBuZycpXHJcbiAgICAgICAgLmFkZCgnY29pbl92ZXJ0aWNhbDInLCAgICAnaW1hZ2VzL2NvaW5fdmVydGljYWwyLnBuZycpXHJcbiAgICAgICAgLmxvYWQoZnVuY3Rpb24gKGxvYWRlcjpQSVhJLmxvYWRlcnMuTG9hZGVyLCBuZXdSZXNvdXJjZXM6YW55KSB7XHJcbiAgICAgICAgICAgIHJlc291cmNlcyA9IG5ld1Jlc291cmNlcztcclxuICAgICAgICAgICAgc2V0dXBUZXh0dXJlUmVzb3VyY2VzKCk7XHJcbiAgICAgICAgICAgIHNldHVwVWkoKTtcclxuICAgICAgICAgICAgc2V0dXBCb2FyZCgpO1xyXG4gICAgICAgICAgICBzZXR1cENvaW5BbmRFeHBsb3Npb24oKTtcclxuICAgICAgICAgICAgcnVuTWFpbkxvb3AoMCk7XHJcbiAgICAgICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldHVwVGV4dHVyZVJlc291cmNlcygpIHtcclxuICAgIGFycm93VGV4dHVyZXMgPSBbXTtcclxuICAgIGFycm93VGV4dHVyZXNbMF0gPSByZXNvdXJjZXMuYXJyb3dfdXAudGV4dHVyZTtcclxuICAgIGFycm93VGV4dHVyZXNbMV0gPSByZXNvdXJjZXMuYXJyb3dfcmlnaHQudGV4dHVyZTtcclxuICAgIGFycm93VGV4dHVyZXNbMl0gPSByZXNvdXJjZXMuYXJyb3dfZG93bi50ZXh0dXJlO1xyXG4gICAgYXJyb3dUZXh0dXJlc1szXSA9IHJlc291cmNlcy5hcnJvd19sZWZ0LnRleHR1cmU7XHJcbiAgICBleHBsb3Npb25UZXh0dXJlcyA9IFtdO1xyXG4gICAgZXhwbG9zaW9uVGV4dHVyZXNbMF0gPSByZXNvdXJjZXMuZXhwbG9zaW9uXzEudGV4dHVyZTtcclxuICAgIGV4cGxvc2lvblRleHR1cmVzWzFdID0gcmVzb3VyY2VzLmV4cGxvc2lvbl8yLnRleHR1cmU7XHJcbiAgICBleHBsb3Npb25UZXh0dXJlc1syXSA9IHJlc291cmNlcy5leHBsb3Npb25fMy50ZXh0dXJlO1xyXG4gICAgZXhwbG9zaW9uVGV4dHVyZXNbM10gPSByZXNvdXJjZXMuZXhwbG9zaW9uXzQudGV4dHVyZTtcclxuICAgIGV4cGxvc2lvblRleHR1cmVzWzRdID0gcmVzb3VyY2VzLmV4cGxvc2lvbl81LnRleHR1cmU7XHJcbiAgICBjb2luVGV4dHVyZXMgPSBbXTtcclxuICAgIGNvaW5UZXh0dXJlc1swXSA9IHJlc291cmNlcy5jb2luLnRleHR1cmU7XHJcbiAgICBjb2luVGV4dHVyZXNbMV0gPSByZXNvdXJjZXMuY29pbl9ob3Jpem9udGFsMS50ZXh0dXJlO1xyXG4gICAgY29pblRleHR1cmVzWzJdID0gcmVzb3VyY2VzLmNvaW5faG9yaXpvbnRhbDIudGV4dHVyZTtcclxuICAgIGNvaW5UZXh0dXJlc1szXSA9IHJlc291cmNlcy5jb2luX3ZlcnRpY2FsMS50ZXh0dXJlO1xyXG4gICAgY29pblRleHR1cmVzWzRdID0gcmVzb3VyY2VzLmNvaW5fdmVydGljYWwyLnRleHR1cmU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldHVwVWkoKSB7XHJcbiAgICAvLyBTZXR1cCBzdHlsZVxyXG4gICAgZm9udFN0eWxlID0gbmV3IFBJWEkuVGV4dFN0eWxlKHtcclxuICAgICAgICBmb250RmFtaWx5OiAnQXJpYWwnLFxyXG4gICAgICAgIGZvbnRTaXplOiAyMCxcclxuICAgICAgICBmaWxsOiAnd2hpdGUnLFxyXG4gICAgfSk7XHJcbiAgICAvLyBTZXR1cCBoZWxwIHRleHRcclxuICAgIGhlbHBUZXh0ID0gbmV3IFBJWEkuVGV4dChcIkNsaWNrIG9uIGEgdGlsZSB0byBkcm9wIGEgY29pbi5cXG5TZWUgcXVpY2tseSB5b3UgY2FuIGZpbmQgdGhlIHBhdGhzIG9mZiBvZiB0aGUgYm9hcmQuXCIsIGZvbnRTdHlsZSk7XHJcbiAgICBoZWxwVGV4dC54ID0gSEVMUF9PRkZTRVRfWDtcclxuICAgIGhlbHBUZXh0LnkgPSBIRUxQX09GRlNFVF9ZO1xyXG4gICAgc3RhZ2UuYWRkQ2hpbGQoaGVscFRleHQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXR1cEJvYXJkKCkge1xyXG4gICAgLy8gU2V0dXAgYm9hcmQgc3ByaXRlc1xyXG4gICAgZm9yICh2YXIgeSA9IDA7IHkgPCBib2FyZFNpemU7ICsreSkge1xyXG4gICAgICAgIGJvYXJkW3ldID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBib2FyZFNpemU7ICsreCkge1xyXG4gICAgICAgICAgICAvLyB0aWxlXHJcbiAgICAgICAgICAgIHZhciB0aWxlVGV4dHVyZSA9ICgoeCArIHkpICUgMiA9PSAwKSA/IHJlc291cmNlcy50aWxlMS50ZXh0dXJlIDogcmVzb3VyY2VzLnRpbGUyLnRleHR1cmU7XHJcbiAgICAgICAgICAgIHZhciBwb3NpdGlvblggPSB4ICogKDY0ICsgQk9BUkRfUEFERElOR19YKSArIEJPQVJEX09GRlNFVF9YO1xyXG4gICAgICAgICAgICB2YXIgcG9zaXRpb25ZID0geSAqICg2NCArIEJPQVJEX1BBRERJTkdfWSkgKyBCT0FSRF9PRkZTRVRfWTtcclxuICAgICAgICAgICAgYm9hcmRbeV1beF0gPSBuZXcgUElYSS5TcHJpdGUodGlsZVRleHR1cmUpO1xyXG4gICAgICAgICAgICB2YXIgdGlsZSA9IGJvYXJkW3ldW3hdO1xyXG4gICAgICAgICAgICB0aWxlLnBvc2l0aW9uLnggPSBwb3NpdGlvblg7XHJcbiAgICAgICAgICAgIHRpbGUucG9zaXRpb24ueSA9IHBvc2l0aW9uWTtcclxuICAgICAgICAgICAgc3RhZ2UuYWRkQ2hpbGQodGlsZSk7XHJcbiAgICAgICAgICAgIC8vIGFycm93XHJcbiAgICAgICAgICAgIHRpbGUuYXJyb3cgPSBuZXcgUElYSS5TcHJpdGUoYXJyb3dUZXh0dXJlc1syXSk7XHJcbiAgICAgICAgICAgIHRpbGUuYXJyb3dUeXBlID0gMjtcclxuICAgICAgICAgICAgdGlsZS5hZGRDaGlsZCh0aWxlLmFycm93KTtcclxuICAgICAgICAgICAgLy8gbW91c2UgY2xpY2tzXHJcbiAgICAgICAgICAgIHRpbGUuaW50ZXJhY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aWxlLmJ1dHRvbk1vZGUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aWxlLm9uKCdtb3VzZXVwJywgb25Cb2FyZENsaWNrKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBTZXR1cCBuZWlnaGJvciBsaW5rc1xyXG4gICAgZm9yICh2YXIgeSA9IDA7IHkgPCBib2FyZFNpemU7ICsreSkge1xyXG4gICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgYm9hcmRTaXplOyArK3gpIHtcclxuICAgICAgICAgICAgdmFyIHRpbGUgPSBib2FyZFt5XVt4XTtcclxuICAgICAgICAgICAgdGlsZS5uZWlnaGJvciA9IFtdO1xyXG4gICAgICAgICAgICBpZiAoeSA+IDApICAgICAgICAgICB7IHRpbGUubmVpZ2hib3JbMF0gPSBib2FyZFt5LTFdW3hdOyB9XHJcbiAgICAgICAgICAgIGlmICh4IDwgYm9hcmRTaXplLTEpIHsgdGlsZS5uZWlnaGJvclsxXSA9IGJvYXJkW3ldW3grMV07IH1cclxuICAgICAgICAgICAgaWYgKHkgPCBib2FyZFNpemUtMSkgeyB0aWxlLm5laWdoYm9yWzJdID0gYm9hcmRbeSsxXVt4XTsgfVxyXG4gICAgICAgICAgICBpZiAoeCA+IDApICAgICAgICAgICB7IHRpbGUubmVpZ2hib3JbM10gPSBib2FyZFt5XVt4LTFdOyB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmFuZG9taXplQm9hcmQoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0dXBDb2luQW5kRXhwbG9zaW9uKCkge1xyXG4gICAgY29pbiA9IG5ldyBQSVhJLlNwcml0ZShyZXNvdXJjZXMuY29pbi50ZXh0dXJlKTtcclxuICAgIGNvaW4uZnJhbWUgPSAtMTtcclxuICAgIGNvaW4udmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgc3RhZ2UuYWRkQ2hpbGQoY29pbik7XHJcbiAgICBleHBsb3Npb24gPSBuZXcgUElYSS5TcHJpdGUoZXhwbG9zaW9uVGV4dHVyZXNbMF0pO1xyXG4gICAgZXhwbG9zaW9uLmZyYW1lID0gLTE7XHJcbiAgICBleHBsb3Npb24udmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgc3RhZ2UuYWRkQ2hpbGQoZXhwbG9zaW9uKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmFuZG9taXplQm9hcmQoKSB7XHJcbiAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGJvYXJkU2l6ZTsgKyt5KSB7XHJcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBib2FyZFNpemU7ICsreCkge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpO1xyXG4gICAgICAgICAgICBib2FyZFt5XVt4XS5hcnJvdy50ZXh0dXJlID0gYXJyb3dUZXh0dXJlc1t0eXBlXTtcclxuICAgICAgICAgICAgYm9hcmRbeV1beF0uYXJyb3dUeXBlID0gdHlwZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9uQm9hcmRDbGljayhldmVudCkge1xyXG4gICAgdmFyIHRpbGUgPSBldmVudC50YXJnZXQ7XHJcbiAgICAvLyByZW1vdmUgdGhlIGV4cGxvc2lvbiAoaWYgc3RpbGwgdmlzaWJsZSlcclxuICAgIGV4cGxvc2lvbi52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAvLyBwbGFjZSB0aGUgY29pblxyXG4gICAgY29pbi50aWxlID0gdGlsZTsgXHJcbiAgICBjb2luLnBvc2l0aW9uID0gdGlsZS5wb3NpdGlvbjtcclxuICAgIGNvaW4uZGlyZWN0aW9uID0gdGlsZS5hcnJvd1R5cGU7XHJcbiAgICBjb2luLnZpc2libGUgPSB0cnVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBydW5GcmFtZUxvZ2ljKCkge1xyXG4gICAgLy8gYW5pbWF0ZSBjb2luXHJcbiAgICBpZiAoY29pbi52aXNpYmxlKSB7XHJcbiAgICAgIGNvaW4uZnJhbWUgKz0gMTtcclxuICAgICAgaWYgKGNvaW4uZnJhbWUgPiAzKSB7IGNvaW4uZnJhbWUgPSAwOyB9XHJcbiAgICAgIGNvaW4udGV4dHVyZSA9IGNvaW5UZXh0dXJlc1tjb2luQW5pbWF0aW9uRnJhbWVzW2NvaW4uZGlyZWN0aW9uXVtjb2luLmZyYW1lXV07XHJcbiAgICB9XHJcbiAgICAvLyBoYW5kbGUgY29pbiBtb3ZlbWVudFxyXG4gICAgaWYgKGNvaW4udmlzaWJsZSAmJiBjb2luLmZyYW1lID09IDIgJiYgIWV4cGxvc2lvbi52aXNpYmxlKSB7XHJcbiAgICAgICAgdmFyIHRpbGUgPSBjb2luLnRpbGU7XHJcbiAgICAgICAgLy8gYWRkIHRvIGNvaW4gdHJhaWxcclxuICAgICAgICB2YXIgbmV3Q29pblRyYWlsID0gbmV3IFBJWEkuU3ByaXRlKHJlc291cmNlcy5jb2luLnRleHR1cmUpO1xyXG4gICAgICAgIGNvaW5UcmFpbC5wdXNoKG5ld0NvaW5UcmFpbCk7XHJcbiAgICAgICAgbmV3Q29pblRyYWlsLnBvc2l0aW9uID0gY29pbi5wb3NpdGlvbjtcclxuICAgICAgICBuZXdDb2luVHJhaWxbXCJ0aWxlXCJdID0gY29pbi50aWxlO1xyXG4gICAgICAgIG5ld0NvaW5UcmFpbC5hbHBoYSA9IC4zNTtcclxuICAgICAgICBzdGFnZS5hZGRDaGlsZChuZXdDb2luVHJhaWwpO1xyXG4gICAgICAgIC8vIEdldCBuZXcgcG9zaXRpb25cclxuICAgICAgICB2YXIgbmV3VGlsZSA9IHRpbGUubmVpZ2hib3JbdGlsZS5hcnJvd1R5cGVdO1xyXG4gICAgICAgIC8vIENoZWNrIGZvciB0cmFpbCBsb29wXHJcbiAgICAgICAgaWYgKG5ld1RpbGUpIHtcclxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29pblRyYWlsLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGNvaW5UcmFpbFtpXS50aWxlID09IG5ld1RpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgZXhwbG9zaW9uLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFJlbW92ZSBjb2luIChpZiBhcHBsaWNhYmxlKVxyXG4gICAgICAgIGlmICghbmV3VGlsZSB8fCBleHBsb3Npb24udmlzaWJsZSkge1xyXG4gICAgICAgICAgICB3aGlsZSAoY29pblRyYWlsLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBjb2luVHJhaWxJdGVtID0gY29pblRyYWlsLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgc3RhZ2UucmVtb3ZlQ2hpbGQoY29pblRyYWlsSXRlbSk7XHJcbiAgICAgICAgICAgICAgICBjb2luVHJhaWxJdGVtLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWV4cGxvc2lvbi52aXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICBjb2luLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNvaW4uZnJhbWUgPSAtMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIC8vIG1vdmUgY29pblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvaW4udGlsZSA9IG5ld1RpbGU7XHJcbiAgICAgICAgICAgIGNvaW4ucG9zaXRpb24gPSBuZXdUaWxlLnBvc2l0aW9uO1xyXG4gICAgICAgICAgICBjb2luLmRpcmVjdGlvbiA9IG5ld1RpbGUuYXJyb3dUeXBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGFuaW1hdGUgZXhwbG9zaW9uXHJcbiAgICBpZiAoZXhwbG9zaW9uLnZpc2libGUpIHtcclxuICAgICAgICArK2V4cGxvc2lvbi5mcmFtZTtcclxuICAgICAgICAvLyBzcGVjaWFsIGZyYW1lc1xyXG4gICAgICAgIGlmIChleHBsb3Npb24uZnJhbWUgPT0gMCkge1xyXG4gICAgICAgICAgZXhwbG9zaW9uLnBvc2l0aW9uID0gY29pbi5wb3NpdGlvbjtcclxuICAgICAgICB9IGVsc2UgaWYgKGV4cGxvc2lvbi5mcmFtZSA9PSAxKSB7XHJcbiAgICAgICAgICBjb2luLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgIGNvaW4uZnJhbWUgPSAtMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gRHJhdyBvciByZW1vdmVcclxuICAgICAgICBpZiAoZXhwbG9zaW9uLmZyYW1lID09IDUpIHtcclxuICAgICAgICAgICAgZXhwbG9zaW9uLnZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgZXhwbG9zaW9uLmZyYW1lID0gLTE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZXhwbG9zaW9uLnRleHR1cmUgPSBleHBsb3Npb25UZXh0dXJlc1tleHBsb3Npb24uZnJhbWVdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcnVuTWFpbkxvb3AodGltZVN0YW1wKSB7XHJcbiAgICAvLyBjYWxsIFwicnVuRnJhbWVMb2dpYygpXCIgYXQgRlJBTUVfU1BFRUQgaW50ZXJ2YWxzXHJcbiAgICBpZiAodGltZVN0YW1wLWZyYW1lVGltZSA+IEZSQU1FX1NQRUVEKSB7XHJcbiAgICAgICAgZnJhbWVUaW1lID0gdGltZVN0YW1wO1xyXG4gICAgICAgIHJ1bkZyYW1lTG9naWMoKTtcclxuICAgIH1cclxuICAgIC8vIFJlbmRlciBhbmQgbG9vcFxyXG4gICAgcmVuZGVyZXIucmVuZGVyKHN0YWdlKTtcclxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShydW5NYWluTG9vcCk7XHJcbn1cclxuXHJcbmluaXRpYWxpemUoKTtcclxuIl19
