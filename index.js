(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.jiboProgrammingChallenge = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var COIN_MEMORY_ALPHA = .35;
var Tile = (function () {
    function Tile(resources, stage, tileType, x, y, onClickCallback, arrowType) {
        if (arrowType === void 0) { arrowType = 0; }
        // static
        if (Tile.arrowTextures == null) {
            Tile.arrowTextures = [];
            Tile.arrowTextures[0] = resources.arrow_up.texture;
            Tile.arrowTextures[1] = resources.arrow_right.texture;
            Tile.arrowTextures[2] = resources.arrow_down.texture;
            Tile.arrowTextures[3] = resources.arrow_left.texture;
        }
        // instance
        // state
        this.x = x;
        this.y = y;
        this.arrowType = arrowType;
        this.neighbors = [null, null, null, null];
        this.hasCoinMemory = false;
        // tile
        this.tileSprite = new PIXI.Sprite(resources["tile_" + tileType].texture);
        stage.addChild(this.tileSprite);
        this.tileSprite.position.x = x;
        this.tileSprite.position.y = y;
        // arrow
        this.arrowSprite = new PIXI.Sprite(Tile.arrowTextures[arrowType]);
        this.tileSprite.addChild(this.arrowSprite);
        // Coin memory
        this.coinMemorySprite = new PIXI.Sprite(resources.coin.texture);
        this.tileSprite.addChild(this.coinMemorySprite);
        this.coinMemorySprite.alpha = COIN_MEMORY_ALPHA;
        this.coinMemorySprite.visible = false;
        // mouse
        this.tileSprite.interactive = true;
        this.tileSprite.buttonMode = true;
        this.tileSprite["tile"] = this;
        this.tileSprite.on('mouseup', onClickCallback);
    }
    Tile.prototype.getArrowType = function () { return this.arrowType; };
    Tile.prototype.getX = function () { return this.x; };
    Tile.prototype.getY = function () { return this.y; };
    Tile.prototype.getNeighbor = function (index) { return this.neighbors[index]; };
    Tile.prototype.getPointedNeighbor = function () { return this.neighbors[this.arrowType]; };
    Tile.prototype.getHasCoinMemory = function () { return this.hasCoinMemory; };
    Tile.prototype.setArrowType = function (value) {
        if (value < 0 || value > 3) {
            return;
        } // TODO: Error reporting
        this.arrowType = value;
        this.arrowSprite.texture = Tile.arrowTextures[value];
    };
    Tile.prototype.setPosition = function (x, y) {
        this.x = x;
        this.y = y;
        this.tileSprite.position.x = x;
        this.tileSprite.position.y = y;
    };
    Tile.prototype.setNeighbor = function (index, neighbor) {
        if (index < 0 || index > 3) {
            return;
        } // TODO: Error reporting
        this.neighbors[index] = neighbor;
    };
    Tile.prototype.setHasCoinMemory = function (value) {
        this.hasCoinMemory = value;
        this.coinMemorySprite.visible = value;
    };
    return Tile;
}());
exports.Tile = Tile;
},{}],2:[function(require,module,exports){
"use strict";
/// <reference path="../typings/index.d.ts" />
var PIXI = require('pixi.js');
//import audio = require('pixi-sound');
var class_tile_1 = require("./class_tile");
// global vars
// system
var renderer = new PIXI.WebGLRenderer(3000, 3000);
var stage = new PIXI.Container();
// game constants
var HELP_OFFSET_X = 10;
var HELP_OFFSET_Y = 10;
var BOARD_OFFSET_X = 10;
var BOARD_OFFSET_Y = 70;
var BOARD_PADDING_X = 2;
var BOARD_PADDING_Y = 2;
var FRAME_SPEED = 100;
var coinAnimationFrames = [[0, 3, 4, 0], [0, 1, 2, 0], [0, 4, 3, 0], [0, 2, 1, 0]];
// game resources
var resources;
var fontStyle;
var arrowTextures;
var explosionTextures;
var coinTextures;
var helpText;
// game state
var boardSize = 10;
var board = [];
var coin;
var explosion;
var frameTime = 0;
function initialize() {
    // System
    document.body.appendChild(renderer.view);
    // Textures
    PIXI.loader
        .add('tile_0', 'images/tile_blue.png')
        .add('tile_1', 'images/tile_green.png')
        .add('arrow_up', 'images/arrow_up.png')
        .add('arrow_right', 'images/arrow_right.png')
        .add('arrow_down', 'images/arrow_down.png')
        .add('arrow_left', 'images/arrow_left.png')
        .add('explosion_1', 'images/explosion_1.png')
        .add('explosion_2', 'images/explosion_2.png')
        .add('explosion_3', 'images/explosion_3.png')
        .add('explosion_4', 'images/explosion_4.png')
        .add('explosion_5', 'images/explosion_5.png')
        .add('coin', 'images/coin.png')
        .add('coin_horizontal1', 'images/coin_horizontal1.png')
        .add('coin_horizontal2', 'images/coin_horizontal2.png')
        .add('coin_vertical1', 'images/coin_vertical1.png')
        .add('coin_vertical2', 'images/coin_vertical2.png')
        .load(function (loader, newResources) {
        resources = newResources;
        setupTextureResources();
        setupUi();
        setupBoard();
        setupCoinAndExplosion();
        runMainLoop(0);
    });
}
function setupTextureResources() {
    arrowTextures = [];
    arrowTextures[0] = resources.arrow_up.texture;
    arrowTextures[1] = resources.arrow_right.texture;
    arrowTextures[2] = resources.arrow_down.texture;
    arrowTextures[3] = resources.arrow_left.texture;
    explosionTextures = [];
    explosionTextures[0] = resources.explosion_1.texture;
    explosionTextures[1] = resources.explosion_2.texture;
    explosionTextures[2] = resources.explosion_3.texture;
    explosionTextures[3] = resources.explosion_4.texture;
    explosionTextures[4] = resources.explosion_5.texture;
    coinTextures = [];
    coinTextures[0] = resources.coin.texture;
    coinTextures[1] = resources.coin_horizontal1.texture;
    coinTextures[2] = resources.coin_horizontal2.texture;
    coinTextures[3] = resources.coin_vertical1.texture;
    coinTextures[4] = resources.coin_vertical2.texture;
}
function setupUi() {
    // Setup style
    fontStyle = new PIXI.TextStyle({
        fontFamily: 'Arial',
        fontSize: 20,
        fill: 'white'
    });
    // Setup help text
    helpText = new PIXI.Text("Click on a tile to drop a coin.\nSee quickly you can find the paths off of the board.", fontStyle);
    helpText.x = HELP_OFFSET_X;
    helpText.y = HELP_OFFSET_Y;
    stage.addChild(helpText);
}
function setupBoard() {
    // Setup board sprites
    for (var y = 0; y < boardSize; ++y) {
        board[y] = [];
        for (var x = 0; x < boardSize; ++x) {
            // tile
            var tileType = ((x + y) % 2);
            var positionX = x * (64 + BOARD_PADDING_X) + BOARD_OFFSET_X;
            var positionY = y * (64 + BOARD_PADDING_Y) + BOARD_OFFSET_Y;
            board[y][x] = new class_tile_1.Tile(resources, stage, tileType, positionX, positionY, onBoardClick);
        }
    }
    // Setup neighbor links
    for (var y = 0; y < boardSize; ++y) {
        for (var x = 0; x < boardSize; ++x) {
            var tile = board[y][x];
            tile.neighbor = [];
            if (y > 0) {
                tile.setNeighbor(0, board[y - 1][x]);
            }
            if (x < boardSize - 1) {
                tile.setNeighbor(1, board[y][x + 1]);
            }
            if (y < boardSize - 1) {
                tile.setNeighbor(2, board[y + 1][x]);
            }
            if (x > 0) {
                tile.setNeighbor(3, board[y][x - 1]);
            }
        }
    }
    randomizeBoard();
}
function setupCoinAndExplosion() {
    coin = new PIXI.Sprite(resources.coin.texture);
    coin.frame = -1;
    coin.visible = false;
    stage.addChild(coin);
    explosion = new PIXI.Sprite(explosionTextures[0]);
    explosion.frame = -1;
    explosion.visible = false;
    stage.addChild(explosion);
}
function randomizeBoard() {
    for (var y = 0; y < boardSize; ++y) {
        for (var x = 0; x < boardSize; ++x) {
            var type = Math.floor(Math.random() * 4);
            board[y][x].setArrowType(type);
        }
    }
}
function onBoardClick(event) {
    var tile = event.target.tile;
    // remove the explosion (if still visible)
    explosion.visible = false;
    // place the coin
    coin.tile = tile;
    coin.position.x = tile.getX();
    coin.position.y = tile.getY();
    coin.direction = tile.getArrowType();
    coin.visible = true;
}
function runFrameLogic() {
    // animate coin
    if (coin.visible) {
        coin.frame += 1;
        if (coin.frame > 3) {
            coin.frame = 0;
        }
        coin.texture = coinTextures[coinAnimationFrames[coin.direction][coin.frame]];
    }
    // handle coin movement
    if (coin.visible && coin.frame == 2 && !explosion.visible) {
        var tile = coin.tile;
        // add to coin trail
        coin.tile.setHasCoinMemory(true);
        // Get new position
        var newTile = tile.getPointedNeighbor();
        // Check for trail loop
        if (newTile != null && newTile.getHasCoinMemory()) {
            explosion.visible = true;
        }
        // Remove coin (if applicable)
        if (!newTile || explosion.visible) {
            for (var y = 0; y < boardSize; ++y) {
                for (var x = 0; x < boardSize; ++x) {
                    board[y][x].setHasCoinMemory(false);
                }
            }
            if (!explosion.visible) {
                coin.visible = false;
                coin.frame = -1;
            }
        }
        else {
            coin.tile = newTile;
            coin.position.x = newTile.getX();
            coin.position.y = newTile.getY();
            coin.direction = newTile.getArrowType();
        }
    }
    // animate explosion
    if (explosion.visible) {
        ++explosion.frame;
        // special frames
        if (explosion.frame == 0) {
            explosion.position = coin.position;
        }
        else if (explosion.frame == 1) {
            coin.visible = false;
            coin.frame = -1;
        }
        // Draw or remove
        if (explosion.frame == 5) {
            explosion.visible = false;
            explosion.frame = -1;
        }
        else {
            explosion.texture = explosionTextures[explosion.frame];
        }
    }
}
function runMainLoop(timeStamp) {
    // call "runFrameLogic()" at FRAME_SPEED intervals
    if (timeStamp - frameTime > FRAME_SPEED) {
        frameTime = timeStamp;
        runFrameLogic();
    }
    // Render and loop
    renderer.render(stage);
    requestAnimationFrame(runMainLoop);
}
initialize();
},{"./class_tile":1,"pixi.js":undefined}]},{},[2])(2)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy93YXRjaGlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL2NsYXNzX3RpbGUudHMiLCJzcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQ0EsSUFBTSxpQkFBaUIsR0FBRyxHQUFHLENBQUM7QUFFOUI7SUFDSSxjQUNRLFNBQVMsRUFBRSxLQUFLLEVBQ2hCLFFBQWUsRUFBRSxDQUFRLEVBQUUsQ0FBUSxFQUNuQyxlQUFlLEVBQUUsU0FBb0I7UUFBcEIseUJBQW9CLEdBQXBCLGFBQW9CO1FBQ3pDLFNBQVM7UUFDVCxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDN0IsSUFBSSxDQUFDLGFBQWEsR0FBRyxFQUFFLENBQUM7WUFDeEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQztZQUNuRCxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDO1lBQ3RELElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEdBQUcsU0FBUyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUM7WUFDckQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQztRQUN6RCxDQUFDO1FBRUQsV0FBVztRQUNQLFFBQVE7UUFDUixJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNYLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ1gsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDM0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxF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LFFBQVEsQ0FBQztRQUNyQyxDQUFDO1FBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoQyxJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUNyQixJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ2xCLENBQUM7UUFDRCxpQkFBaUI7UUFDakIsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3ZCLFNBQVMsQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1lBQzFCLFNBQVMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDekIsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osU0FBUyxDQUFDLE9BQU8sR0FBRyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDM0QsQ0FBQztJQUNMLENBQUM7QUFDTCxDQUFDO0FBRUQscUJBQXFCLFNBQVM7SUFDMUIsa0RBQWtEO0lBQ2xELEVBQUUsQ0FBQyxDQUFDLFNBQVMsR0FBQyxTQUFTLEdBQUcsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUNwQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQ3RCLGFBQWEsRUFBRSxDQUFDO0lBQ3BCLENBQUM7SUFDRCxrQkFBa0I7SUFDbEIsUUFBUSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN2QixxQkFBcUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUN2QyxDQUFDO0FBRUQsVUFBVSxFQUFFLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXHJcbmNvbnN0IENPSU5fTUVNT1JZX0FMUEhBID0gLjM1O1xyXG5cclxuZXhwb3J0IGNsYXNzIFRpbGUge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgICAgIHJlc291cmNlcywgc3RhZ2UsXHJcbiAgICAgICAgICAgIHRpbGVUeXBlOm51bWJlciwgeDpudW1iZXIsIHk6bnVtYmVyLFxyXG4gICAgICAgICAgICBvbkNsaWNrQ2FsbGJhY2ssIGFycm93VHlwZTpudW1iZXIgPSAwKSB7XHJcbiAgICAgICAgLy8gc3RhdGljXHJcbiAgICAgICAgaWYgKFRpbGUuYXJyb3dUZXh0dXJlcyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIFRpbGUuYXJyb3dUZXh0dXJlcyA9IFtdO1xyXG4gICAgICAgICAgICBUaWxlLmFycm93VGV4dHVyZXNbMF0gPSByZXNvdXJjZXMuYXJyb3dfdXAudGV4dHVyZTtcclxuICAgICAgICAgICAgVGlsZS5hcnJvd1RleHR1cmVzWzFdID0gcmVzb3VyY2VzLmFycm93X3JpZ2h0LnRleHR1cmU7XHJcbiAgICAgICAgICAgIFRpbGUuYXJyb3dUZXh0dXJlc1syXSA9IHJlc291cmNlcy5hcnJvd19kb3duLnRleHR1cmU7XHJcbiAgICAgICAgICAgIFRpbGUuYXJyb3dUZXh0dXJlc1szXSA9IHJlc291cmNlcy5hcnJvd19sZWZ0LnRleHR1cmU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBpbnN0YW5jZVxyXG4gICAgICAgICAgICAvLyBzdGF0ZVxyXG4gICAgICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICAgICAgICB0aGlzLmFycm93VHlwZSA9IGFycm93VHlwZTtcclxuICAgICAgICAgICAgdGhpcy5uZWlnaGJvcnMgPSBbbnVsbCwgbnVsbCwgbnVsbCwgbnVsbF07XHJcbiAgICAgICAgICAgIHRoaXMuaGFzQ29pbk1lbW9yeSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyB0aWxlXHJcbiAgICAgICAgICAgIHRoaXMudGlsZVNwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZShyZXNvdXJjZXNbXCJ0aWxlX1wiICsgdGlsZVR5cGVdLnRleHR1cmUpO1xyXG4gICAgICAgICAgICBzdGFnZS5hZGRDaGlsZCh0aGlzLnRpbGVTcHJpdGUpO1xyXG4gICAgICAgICAgICB0aGlzLnRpbGVTcHJpdGUucG9zaXRpb24ueCA9IHg7XHJcbiAgICAgICAgICAgIHRoaXMudGlsZVNwcml0ZS5wb3NpdGlvbi55ID0geTtcclxuICAgICAgICAgICAgLy8gYXJyb3dcclxuICAgICAgICAgICAgdGhpcy5hcnJvd1Nwcml0ZSA9IG5ldyBQSVhJLlNwcml0ZShUaWxlLmFycm93VGV4dHVyZXNbYXJyb3dUeXBlXSk7XHJcbiAgICAgICAgICAgIHRoaXMudGlsZVNwcml0ZS5hZGRDaGlsZCh0aGlzLmFycm93U3ByaXRlKTtcclxuICAgICAgICAgICAgLy8gQ29pbiBtZW1vcnlcclxuICAgICAgICAgICAgdGhpcy5jb2luTWVtb3J5U3ByaXRlID0gbmV3IFBJWEkuU3ByaXRlKHJlc291cmNlcy5jb2luLnRleHR1cmUpO1xyXG4gICAgICAgICAgICB0aGlzLnRpbGVTcHJpdGUuYWRkQ2hpbGQodGhpcy5jb2luTWVtb3J5U3ByaXRlKTtcclxuICAgICAgICAgICAgdGhpcy5jb2luTWVtb3J5U3ByaXRlLmFscGhhID0gQ09JTl9NRU1PUllfQUxQSEE7XHJcbiAgICAgICAgICAgIHRoaXMuY29pbk1lbW9yeVNwcml0ZS52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIG1vdXNlXHJcbiAgICAgICAgICAgIHRoaXMudGlsZVNwcml0ZS5pbnRlcmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGlsZVNwcml0ZS5idXR0b25Nb2RlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy50aWxlU3ByaXRlW1widGlsZVwiXSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMudGlsZVNwcml0ZS5vbignbW91c2V1cCcsIG9uQ2xpY2tDYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldEFycm93VHlwZSgpIDogbnVtYmVyIHsgcmV0dXJuIHRoaXMuYXJyb3dUeXBlOyB9XHJcbiAgICBwdWJsaWMgZ2V0WCgpIDogbnVtYmVyIHsgcmV0dXJuIHRoaXMueDsgfVxyXG4gICAgcHVibGljIGdldFkoKSA6IG51bWJlciB7IHJldHVybiB0aGlzLnk7IH1cclxuICAgIHB1YmxpYyBnZXROZWlnaGJvcihpbmRleCA6IG51bWJlcikgOiBUaWxlIHsgcmV0dXJuIHRoaXMubmVpZ2hib3JzW2luZGV4XTsgfVxyXG4gICAgcHVibGljIGdldFBvaW50ZWROZWlnaGJvcigpIDogVGlsZSB7IHJldHVybiB0aGlzLm5laWdoYm9yc1t0aGlzLmFycm93VHlwZV07IH1cclxuICAgIHB1YmxpYyBnZXRIYXNDb2luTWVtb3J5KCkgOiBib29sZWFuIHsgcmV0dXJuIHRoaXMuaGFzQ29pbk1lbW9yeTsgfVxyXG5cclxuICAgIHB1YmxpYyBzZXRBcnJvd1R5cGUodmFsdWUgOiBudW1iZXIpIHtcclxuICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID4gMykgeyByZXR1cm47IH0gLy8gVE9ETzogRXJyb3IgcmVwb3J0aW5nXHJcbiAgICAgICAgdGhpcy5hcnJvd1R5cGUgPSB2YWx1ZTtcclxuICAgICAgICB0aGlzLmFycm93U3ByaXRlLnRleHR1cmUgPSBUaWxlLmFycm93VGV4dHVyZXNbdmFsdWVdO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXRQb3NpdGlvbih4IDogbnVtYmVyLCB5IDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy54ID0geDtcclxuICAgICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICAgIHRoaXMudGlsZVNwcml0ZS5wb3NpdGlvbi54ID0geDtcclxuICAgICAgICB0aGlzLnRpbGVTcHJpdGUucG9zaXRpb24ueSA9IHk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldE5laWdoYm9yKGluZGV4IDogbnVtYmVyLCBuZWlnaGJvciA6IFRpbGUpIHtcclxuICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID4gMykgeyByZXR1cm47IH0gLy8gVE9ETzogRXJyb3IgcmVwb3J0aW5nXHJcbiAgICAgICAgdGhpcy5uZWlnaGJvcnNbaW5kZXhdID0gbmVpZ2hib3I7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldEhhc0NvaW5NZW1vcnkodmFsdWUgOiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5oYXNDb2luTWVtb3J5ID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5jb2luTWVtb3J5U3ByaXRlLnZpc2libGUgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTdGF0ZVxyXG4gICAgcHJpdmF0ZSB4IDogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSB5IDogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSBhcnJvd1R5cGUgOiBudW1iZXI7XHJcbiAgICBwcml2YXRlIG5laWdoYm9ycyA6IEFycmF5PFRpbGU+O1xyXG4gICAgcHJpdmF0ZSBoYXNDb2luTWVtb3J5IDogYm9vbGVhbjtcclxuICAgIC8vIE1lZGlhXHJcbiAgICBwcml2YXRlIHRpbGVTcHJpdGUgOiBQSVhJLlNwcml0ZTtcclxuICAgIHByaXZhdGUgYXJyb3dTcHJpdGUgOiBQSVhJLlNwcml0ZTtcclxuICAgIHByaXZhdGUgY29pbk1lbW9yeVNwcml0ZSA6IFBJWEkuU3ByaXRlO1xyXG4gICAgLy8gU3RhdGljXHJcbiAgICBzdGF0aWMgYXJyb3dUZXh0dXJlcyA6IEFycmF5PFBJWEkuVGV4dHVyZT47XHJcbn1cclxuIiwiXHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90eXBpbmdzL2luZGV4LmQudHNcIiAvPlxyXG5pbXBvcnQgUElYSSA9IHJlcXVpcmUoJ3BpeGkuanMnKTtcclxuLy9pbXBvcnQgYXVkaW8gPSByZXF1aXJlKCdwaXhpLXNvdW5kJyk7XHJcbmltcG9ydCB7IFRpbGUgfSBmcm9tIFwiLi9jbGFzc190aWxlXCI7XHJcblxyXG4vLyBnbG9iYWwgdmFyc1xyXG4gICAgLy8gc3lzdGVtXHJcbiAgICBjb25zdCByZW5kZXJlcjpQSVhJLldlYkdMUmVuZGVyZXIgPSBuZXcgUElYSS5XZWJHTFJlbmRlcmVyKDMwMDAsIDMwMDApO1xyXG4gICAgY29uc3Qgc3RhZ2U6UElYSS5Db250YWluZXIgPSBuZXcgUElYSS5Db250YWluZXIoKTtcclxuICAgIC8vIGdhbWUgY29uc3RhbnRzXHJcbiAgICBjb25zdCBIRUxQX09GRlNFVF9YID0gMTA7XHJcbiAgICBjb25zdCBIRUxQX09GRlNFVF9ZID0gMTA7XHJcbiAgICBjb25zdCBCT0FSRF9PRkZTRVRfWCA9IDEwO1xyXG4gICAgY29uc3QgQk9BUkRfT0ZGU0VUX1kgPSA3MDtcclxuICAgIGNvbnN0IEJPQVJEX1BBRERJTkdfWCA9IDI7XHJcbiAgICBjb25zdCBCT0FSRF9QQURESU5HX1kgPSAyO1xyXG4gICAgY29uc3QgRlJBTUVfU1BFRUQgPSAxMDA7XHJcbiAgICBjb25zdCBjb2luQW5pbWF0aW9uRnJhbWVzID0gW1swLDMsNCwwXSxbMCwxLDIsMF0sWzAsNCwzLDBdLFswLDIsMSwwXV07XHJcbiAgICAvLyBnYW1lIHJlc291cmNlc1xyXG4gICAgbGV0IHJlc291cmNlczphbnk7XHJcbiAgICB2YXIgZm9udFN0eWxlO1xyXG4gICAgdmFyIGFycm93VGV4dHVyZXM7XHJcbiAgICB2YXIgZXhwbG9zaW9uVGV4dHVyZXM7XHJcbiAgICB2YXIgY29pblRleHR1cmVzO1xyXG4gICAgdmFyIGhlbHBUZXh0O1xyXG4gICAgLy8gZ2FtZSBzdGF0ZVxyXG4gICAgdmFyIGJvYXJkU2l6ZSA9IDEwO1xyXG4gICAgdmFyIGJvYXJkID0gW107XHJcbiAgICB2YXIgY29pbjtcclxuICAgIHZhciBleHBsb3Npb247XHJcbiAgICB2YXIgZnJhbWVUaW1lID0gMDtcclxuXHJcbmZ1bmN0aW9uIGluaXRpYWxpemUoKSB7XHJcbiAgICAvLyBTeXN0ZW1cclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocmVuZGVyZXIudmlldyk7XHJcbiAgICAvLyBUZXh0dXJlc1xyXG4gICAgUElYSS5sb2FkZXJcclxuICAgICAgICAuYWRkKCd0aWxlXzAnLCAnaW1hZ2VzL3RpbGVfYmx1ZS5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ3RpbGVfMScsICdpbWFnZXMvdGlsZV9ncmVlbi5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ2Fycm93X3VwJywgJ2ltYWdlcy9hcnJvd191cC5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ2Fycm93X3JpZ2h0JywgJ2ltYWdlcy9hcnJvd19yaWdodC5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ2Fycm93X2Rvd24nLCAnaW1hZ2VzL2Fycm93X2Rvd24ucG5nJylcclxuICAgICAgICAuYWRkKCdhcnJvd19sZWZ0JywgJ2ltYWdlcy9hcnJvd19sZWZ0LnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzEnLCAnaW1hZ2VzL2V4cGxvc2lvbl8xLnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzInLCAnaW1hZ2VzL2V4cGxvc2lvbl8yLnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzMnLCAnaW1hZ2VzL2V4cGxvc2lvbl8zLnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzQnLCAnaW1hZ2VzL2V4cGxvc2lvbl80LnBuZycpXHJcbiAgICAgICAgLmFkZCgnZXhwbG9zaW9uXzUnLCAnaW1hZ2VzL2V4cGxvc2lvbl81LnBuZycpXHJcbiAgICAgICAgLmFkZCgnY29pbicsICAgICdpbWFnZXMvY29pbi5wbmcnKVxyXG4gICAgICAgIC5hZGQoJ2NvaW5faG9yaXpvbnRhbDEnLCAgICAnaW1hZ2VzL2NvaW5faG9yaXpvbnRhbDEucG5nJylcclxuICAgICAgICAuYWRkKCdjb2luX2hvcml6b250YWwyJywgICAgJ2ltYWdlcy9jb2luX2hvcml6b250YWwyLnBuZycpXHJcbiAgICAgICAgLmFkZCgnY29pbl92ZXJ0aWNhbDEnLCAgICAnaW1hZ2VzL2NvaW5fdmVydGljYWwxLnBuZycpXHJcbiAgICAgICAgLmFkZCgnY29pbl92ZXJ0aWNhbDInLCAgICAnaW1hZ2VzL2NvaW5fdmVydGljYWwyLnBuZycpXHJcbiAgICAgICAgLmxvYWQoZnVuY3Rpb24gKGxvYWRlcjpQSVhJLmxvYWRlcnMuTG9hZGVyLCBuZXdSZXNvdXJjZXM6YW55KSB7XHJcbiAgICAgICAgICAgIHJlc291cmNlcyA9IG5ld1Jlc291cmNlcztcclxuICAgICAgICAgICAgc2V0dXBUZXh0dXJlUmVzb3VyY2VzKCk7XHJcbiAgICAgICAgICAgIHNldHVwVWkoKTtcclxuICAgICAgICAgICAgc2V0dXBCb2FyZCgpO1xyXG4gICAgICAgICAgICBzZXR1cENvaW5BbmRFeHBsb3Npb24oKTtcclxuICAgICAgICAgICAgcnVuTWFpbkxvb3AoMCk7XHJcbiAgICAgICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldHVwVGV4dHVyZVJlc291cmNlcygpIHtcclxuICAgIGFycm93VGV4dHVyZXMgPSBbXTtcclxuICAgIGFycm93VGV4dHVyZXNbMF0gPSByZXNvdXJjZXMuYXJyb3dfdXAudGV4dHVyZTtcclxuICAgIGFycm93VGV4dHVyZXNbMV0gPSByZXNvdXJjZXMuYXJyb3dfcmlnaHQudGV4dHVyZTtcclxuICAgIGFycm93VGV4dHVyZXNbMl0gPSByZXNvdXJjZXMuYXJyb3dfZG93bi50ZXh0dXJlO1xyXG4gICAgYXJyb3dUZXh0dXJlc1szXSA9IHJlc291cmNlcy5hcnJvd19sZWZ0LnRleHR1cmU7XHJcbiAgICBleHBsb3Npb25UZXh0dXJlcyA9IFtdO1xyXG4gICAgZXhwbG9zaW9uVGV4dHVyZXNbMF0gPSByZXNvdXJjZXMuZXhwbG9zaW9uXzEudGV4dHVyZTtcclxuICAgIGV4cGxvc2lvblRleHR1cmVzWzFdID0gcmVzb3VyY2VzLmV4cGxvc2lvbl8yLnRleHR1cmU7XHJcbiAgICBleHBsb3Npb25UZXh0dXJlc1syXSA9IHJlc291cmNlcy5leHBsb3Npb25fMy50ZXh0dXJlO1xyXG4gICAgZXhwbG9zaW9uVGV4dHVyZXNbM10gPSByZXNvdXJjZXMuZXhwbG9zaW9uXzQudGV4dHVyZTtcclxuICAgIGV4cGxvc2lvblRleHR1cmVzWzRdID0gcmVzb3VyY2VzLmV4cGxvc2lvbl81LnRleHR1cmU7XHJcbiAgICBjb2luVGV4dHVyZXMgPSBbXTtcclxuICAgIGNvaW5UZXh0dXJlc1swXSA9IHJlc291cmNlcy5jb2luLnRleHR1cmU7XHJcbiAgICBjb2luVGV4dHVyZXNbMV0gPSByZXNvdXJjZXMuY29pbl9ob3Jpem9udGFsMS50ZXh0dXJlO1xyXG4gICAgY29pblRleHR1cmVzWzJdID0gcmVzb3VyY2VzLmNvaW5faG9yaXpvbnRhbDIudGV4dHVyZTtcclxuICAgIGNvaW5UZXh0dXJlc1szXSA9IHJlc291cmNlcy5jb2luX3ZlcnRpY2FsMS50ZXh0dXJlO1xyXG4gICAgY29pblRleHR1cmVzWzRdID0gcmVzb3VyY2VzLmNvaW5fdmVydGljYWwyLnRleHR1cmU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldHVwVWkoKSB7XHJcbiAgICAvLyBTZXR1cCBzdHlsZVxyXG4gICAgZm9udFN0eWxlID0gbmV3IFBJWEkuVGV4dFN0eWxlKHtcclxuICAgICAgICBmb250RmFtaWx5OiAnQXJpYWwnLFxyXG4gICAgICAgIGZvbnRTaXplOiAyMCxcclxuICAgICAgICBmaWxsOiAnd2hpdGUnLFxyXG4gICAgfSk7XHJcbiAgICAvLyBTZXR1cCBoZWxwIHRleHRcclxuICAgIGhlbHBUZXh0ID0gbmV3IFBJWEkuVGV4dChcIkNsaWNrIG9uIGEgdGlsZSB0byBkcm9wIGEgY29pbi5cXG5TZWUgcXVpY2tseSB5b3UgY2FuIGZpbmQgdGhlIHBhdGhzIG9mZiBvZiB0aGUgYm9hcmQuXCIsIGZvbnRTdHlsZSk7XHJcbiAgICBoZWxwVGV4dC54ID0gSEVMUF9PRkZTRVRfWDtcclxuICAgIGhlbHBUZXh0LnkgPSBIRUxQX09GRlNFVF9ZO1xyXG4gICAgc3RhZ2UuYWRkQ2hpbGQoaGVscFRleHQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXR1cEJvYXJkKCkge1xyXG4gICAgLy8gU2V0dXAgYm9hcmQgc3ByaXRlc1xyXG4gICAgZm9yICh2YXIgeSA9IDA7IHkgPCBib2FyZFNpemU7ICsreSkge1xyXG4gICAgICAgIGJvYXJkW3ldID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBib2FyZFNpemU7ICsreCkge1xyXG4gICAgICAgICAgICAvLyB0aWxlXHJcbiAgICAgICAgICAgIHZhciB0aWxlVHlwZSA9ICgoeCArIHkpICUgMik7XHJcbiAgICAgICAgICAgIHZhciBwb3NpdGlvblggPSB4ICogKDY0ICsgQk9BUkRfUEFERElOR19YKSArIEJPQVJEX09GRlNFVF9YO1xyXG4gICAgICAgICAgICB2YXIgcG9zaXRpb25ZID0geSAqICg2NCArIEJPQVJEX1BBRERJTkdfWSkgKyBCT0FSRF9PRkZTRVRfWTtcclxuICAgICAgICAgICAgYm9hcmRbeV1beF0gPSBuZXcgVGlsZShyZXNvdXJjZXMsIHN0YWdlLCB0aWxlVHlwZSwgcG9zaXRpb25YLCBwb3NpdGlvblksIG9uQm9hcmRDbGljayk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gU2V0dXAgbmVpZ2hib3IgbGlua3NcclxuICAgIGZvciAodmFyIHkgPSAwOyB5IDwgYm9hcmRTaXplOyArK3kpIHtcclxuICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGJvYXJkU2l6ZTsgKyt4KSB7XHJcbiAgICAgICAgICAgIHZhciB0aWxlID0gYm9hcmRbeV1beF07XHJcbiAgICAgICAgICAgIHRpbGUubmVpZ2hib3IgPSBbXTtcclxuICAgICAgICAgICAgaWYgKHkgPiAwKSAgICAgICAgICAgeyB0aWxlLnNldE5laWdoYm9yKDAsIGJvYXJkW3ktMV1beF0pOyB9XHJcbiAgICAgICAgICAgIGlmICh4IDwgYm9hcmRTaXplLTEpIHsgdGlsZS5zZXROZWlnaGJvcigxLCBib2FyZFt5XVt4KzFdKTsgfVxyXG4gICAgICAgICAgICBpZiAoeSA8IGJvYXJkU2l6ZS0xKSB7IHRpbGUuc2V0TmVpZ2hib3IoMiwgYm9hcmRbeSsxXVt4XSk7IH1cclxuICAgICAgICAgICAgaWYgKHggPiAwKSAgICAgICAgICAgeyB0aWxlLnNldE5laWdoYm9yKDMsIGJvYXJkW3ldW3gtMV0pOyB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmFuZG9taXplQm9hcmQoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0dXBDb2luQW5kRXhwbG9zaW9uKCkge1xyXG4gICAgY29pbiA9IG5ldyBQSVhJLlNwcml0ZShyZXNvdXJjZXMuY29pbi50ZXh0dXJlKTtcclxuICAgIGNvaW4uZnJhbWUgPSAtMTtcclxuICAgIGNvaW4udmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgc3RhZ2UuYWRkQ2hpbGQoY29pbik7XHJcbiAgICBleHBsb3Npb24gPSBuZXcgUElYSS5TcHJpdGUoZXhwbG9zaW9uVGV4dHVyZXNbMF0pO1xyXG4gICAgZXhwbG9zaW9uLmZyYW1lID0gLTE7XHJcbiAgICBleHBsb3Npb24udmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgc3RhZ2UuYWRkQ2hpbGQoZXhwbG9zaW9uKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmFuZG9taXplQm9hcmQoKSB7XHJcbiAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGJvYXJkU2l6ZTsgKyt5KSB7XHJcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBib2FyZFNpemU7ICsreCkge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpO1xyXG4gICAgICAgICAgICBib2FyZFt5XVt4XS5zZXRBcnJvd1R5cGUodHlwZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvbkJvYXJkQ2xpY2soZXZlbnQpIHtcclxuICAgIHZhciB0aWxlID0gZXZlbnQudGFyZ2V0LnRpbGU7XHJcbiAgICAvLyByZW1vdmUgdGhlIGV4cGxvc2lvbiAoaWYgc3RpbGwgdmlzaWJsZSlcclxuICAgIGV4cGxvc2lvbi52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAvLyBwbGFjZSB0aGUgY29pblxyXG4gICAgY29pbi50aWxlID0gdGlsZTsgXHJcbiAgICBjb2luLnBvc2l0aW9uLnggPSB0aWxlLmdldFgoKTtcclxuICAgIGNvaW4ucG9zaXRpb24ueSA9IHRpbGUuZ2V0WSgpO1xyXG4gICAgY29pbi5kaXJlY3Rpb24gPSB0aWxlLmdldEFycm93VHlwZSgpO1xyXG4gICAgY29pbi52aXNpYmxlID0gdHJ1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gcnVuRnJhbWVMb2dpYygpIHtcclxuICAgIC8vIGFuaW1hdGUgY29pblxyXG4gICAgaWYgKGNvaW4udmlzaWJsZSkge1xyXG4gICAgICBjb2luLmZyYW1lICs9IDE7XHJcbiAgICAgIGlmIChjb2luLmZyYW1lID4gMykgeyBjb2luLmZyYW1lID0gMDsgfVxyXG4gICAgICBjb2luLnRleHR1cmUgPSBjb2luVGV4dHVyZXNbY29pbkFuaW1hdGlvbkZyYW1lc1tjb2luLmRpcmVjdGlvbl1bY29pbi5mcmFtZV1dO1xyXG4gICAgfVxyXG4gICAgLy8gaGFuZGxlIGNvaW4gbW92ZW1lbnRcclxuICAgIGlmIChjb2luLnZpc2libGUgJiYgY29pbi5mcmFtZSA9PSAyICYmICFleHBsb3Npb24udmlzaWJsZSkge1xyXG4gICAgICAgIHZhciB0aWxlID0gY29pbi50aWxlO1xyXG4gICAgICAgIC8vIGFkZCB0byBjb2luIHRyYWlsXHJcbiAgICAgICAgICBjb2luLnRpbGUuc2V0SGFzQ29pbk1lbW9yeSh0cnVlKTtcclxuICAgICAgICAvLyBHZXQgbmV3IHBvc2l0aW9uXHJcbiAgICAgICAgdmFyIG5ld1RpbGUgPSB0aWxlLmdldFBvaW50ZWROZWlnaGJvcigpO1xyXG4gICAgICAgIC8vIENoZWNrIGZvciB0cmFpbCBsb29wXHJcbiAgICAgICAgaWYgKG5ld1RpbGUgIT0gbnVsbCAmJiBuZXdUaWxlLmdldEhhc0NvaW5NZW1vcnkoKSkge1xyXG4gICAgICAgICAgICBleHBsb3Npb24udmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFJlbW92ZSBjb2luIChpZiBhcHBsaWNhYmxlKVxyXG4gICAgICAgIGlmICghbmV3VGlsZSB8fCBleHBsb3Npb24udmlzaWJsZSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGJvYXJkU2l6ZTsgKyt5KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGJvYXJkU2l6ZTsgKyt4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9hcmRbeV1beF0uc2V0SGFzQ29pbk1lbW9yeShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFleHBsb3Npb24udmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgY29pbi52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBjb2luLmZyYW1lID0gLTE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAvLyBtb3ZlIGNvaW5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb2luLnRpbGUgPSBuZXdUaWxlO1xyXG4gICAgICAgICAgICBjb2luLnBvc2l0aW9uLnggPSBuZXdUaWxlLmdldFgoKTtcclxuICAgICAgICAgICAgY29pbi5wb3NpdGlvbi55ID0gbmV3VGlsZS5nZXRZKCk7XHJcbiAgICAgICAgICAgIGNvaW4uZGlyZWN0aW9uID0gbmV3VGlsZS5nZXRBcnJvd1R5cGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBhbmltYXRlIGV4cGxvc2lvblxyXG4gICAgaWYgKGV4cGxvc2lvbi52aXNpYmxlKSB7XHJcbiAgICAgICAgKytleHBsb3Npb24uZnJhbWU7XHJcbiAgICAgICAgLy8gc3BlY2lhbCBmcmFtZXNcclxuICAgICAgICBpZiAoZXhwbG9zaW9uLmZyYW1lID09IDApIHtcclxuICAgICAgICAgIGV4cGxvc2lvbi5wb3NpdGlvbiA9IGNvaW4ucG9zaXRpb247XHJcbiAgICAgICAgfSBlbHNlIGlmIChleHBsb3Npb24uZnJhbWUgPT0gMSkge1xyXG4gICAgICAgICAgY29pbi52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICBjb2luLmZyYW1lID0gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIERyYXcgb3IgcmVtb3ZlXHJcbiAgICAgICAgaWYgKGV4cGxvc2lvbi5mcmFtZSA9PSA1KSB7XHJcbiAgICAgICAgICAgIGV4cGxvc2lvbi52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGV4cGxvc2lvbi5mcmFtZSA9IC0xO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGV4cGxvc2lvbi50ZXh0dXJlID0gZXhwbG9zaW9uVGV4dHVyZXNbZXhwbG9zaW9uLmZyYW1lXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJ1bk1haW5Mb29wKHRpbWVTdGFtcCkge1xyXG4gICAgLy8gY2FsbCBcInJ1bkZyYW1lTG9naWMoKVwiIGF0IEZSQU1FX1NQRUVEIGludGVydmFsc1xyXG4gICAgaWYgKHRpbWVTdGFtcC1mcmFtZVRpbWUgPiBGUkFNRV9TUEVFRCkge1xyXG4gICAgICAgIGZyYW1lVGltZSA9IHRpbWVTdGFtcDtcclxuICAgICAgICBydW5GcmFtZUxvZ2ljKCk7XHJcbiAgICB9XHJcbiAgICAvLyBSZW5kZXIgYW5kIGxvb3BcclxuICAgIHJlbmRlcmVyLnJlbmRlcihzdGFnZSk7XHJcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUocnVuTWFpbkxvb3ApO1xyXG59XHJcblxyXG5pbml0aWFsaXplKCk7XHJcbiJdfQ==
